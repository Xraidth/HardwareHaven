{"version":3,"names":["cov_ok2mlm5lm","actualCoverage","s","core_1","require","session_service_1","purchase_service_1","purchase_line_service_1","sweet_alert_service_1","http_1","forms_1","common_1","SummaryPurchaseComponent","constructor","serverCompra","serverLineaCompra","sweetAlertService","f","purchasesLine","loading","purchaseFinished","ngOnInit","user","SessionService","b","carrito","shopcar","generatePurchase","showError","create","userId","id","pipe","subscribe","next","r","data","purchaseMade","length","p","generatePurchaseLine","total","error","e","compraId","cantidad","quantity","componenteId","purchaseLineMade","push","invoice","facturate","response","url","window","URL","createObjectURL","open","invoiceButton","exports","tslib_1","__decorate","Component","selector","standalone","imports","CommonModule","HttpClientModule","FormsModule","template","providers","PurchaseService","PurchaseLineService"],"sources":["C:\\Users\\Samsung\\Desktop\\HardwareHaven\\Frontend\\HardwareHaven\\src\\app\\features\\purchases\\resumenCompra\\resumen-compra\\summary-purchase.component.ts"],"sourcesContent":["import { Component, NgModule, OnInit } from '@angular/core';\r\nimport { SessionService } from '../../../../core/services/share/session.service';\r\nimport { PurchaseService } from '../../../../core/services/entities/purchase.service';\r\nimport { PurchaseLineService } from '../../../../core/services/entities/purchase-line.service';\r\nimport { SweetAlertService } from '../../../../core/services/notifications/sweet-alert.service';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { CommonModule ,  NgIf} from '@angular/common';\r\n\r\n\r\n@Component({\r\n  selector: 'app-summary-purchase',\r\n  standalone: true,\r\n  imports: [CommonModule,HttpClientModule, FormsModule],\r\n  templateUrl: './summary-purchase.component.html',\r\n  styleUrls: ['./summary-purchase.component.css'],\r\n  providers: [PurchaseService, PurchaseLineService]\r\n})\r\nexport class SummaryPurchaseComponent implements OnInit {\r\n  public user: any;\r\n  public shopcar: any;\r\n  public sale: any;\r\n  public purchaseMade: any;\r\n  public purchasesLine: any[] = [];\r\n  public total: any;\r\n  public loading: boolean = false;\r\n  public purchaseFinished: boolean = false;\r\n\r\n\r\n  constructor(\r\n    private serverCompra: PurchaseService,\r\n    private serverLineaCompra: PurchaseLineService,\r\n    private sweetAlertService: SweetAlertService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n\r\n    this.user = SessionService.user;\r\n    if (this.user && this.user.carrito) {\r\n      this.shopcar = this.user.carrito;\r\n      this.generatePurchase();}\r\n    else{\r\n      this.sweetAlertService.showError('Cart shop or user information was not founded');\r\n      return;\r\n    }\r\n\r\n\r\n\r\n  }\r\n\r\n  generatePurchase() {\r\n    this.loading = true;\r\n    this.purchaseFinished = false;\r\n\r\n    this.serverCompra.create({ userId: this.user.id }).pipe(\r\n    ).subscribe({\r\n      next: (r: any) => {\r\n        if (r && r.data) {\r\n          this.purchaseMade = r.data;\r\n\r\n          if (this.shopcar && this.shopcar.length) {\r\n            for (const p of this.shopcar) {\r\n              this.generatePurchaseLine(p);\r\n            }\r\n            this.total = SessionService.user.carrito.total;\r\n            this.purchaseMade.total = this.total;\r\n            this.purchaseFinished = true;\r\n          } else {\r\n            this.sweetAlertService.showError('The shop car is empty');\r\n          }\r\n        } else {\r\n          this.sweetAlertService.showError('There was an error.');\r\n        }\r\n        this.loading = false;\r\n      },\r\n      error: (e) => {\r\n        this.sweetAlertService.showError('Error to generate purchase');\r\n        this.loading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n\r\n  generatePurchaseLine(p: any) {\r\n    if (!this.purchaseMade || !this.purchaseMade.id) {\r\n      this.sweetAlertService.showError('Invalid purchase line');\r\n      return;\r\n    }\r\n\r\n    this.serverLineaCompra.create({\r\n      compraId: this.purchaseMade.id,\r\n      cantidad: p.quantity,\r\n      componenteId: p.id\r\n    }).subscribe({\r\n      next: (r: any) => {\r\n        if (r && r.data) {\r\n          const purchaseLineMade: any = r.data;\r\n          this.purchasesLine.push(purchaseLineMade);\r\n        } else {\r\n          this.sweetAlertService.showError('Error in the creation of the purchase');\r\n        }\r\n      },\r\n      error: (e) => {\r\n        this.sweetAlertService.showError('Error in the creation of the purchase');\r\n      }\r\n    });\r\n  }\r\n\r\n  invoice(id: number) {\r\n    this.serverCompra.facturate(id).subscribe({\r\n      next: (response: Blob) => {\r\n\r\n        const url = window.URL.createObjectURL(response);\r\n\r\n        window.open(url, '_blank');\r\n      },\r\n      error: (error) => {\r\n\r\n        this.sweetAlertService.showError('Purchase billing Error');\r\n      },\r\n    });\r\n  }\r\n\r\n\r\n\r\n  invoiceButton(){\r\n  this.invoice(this.purchaseMade.id);\r\n}\r\n\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}